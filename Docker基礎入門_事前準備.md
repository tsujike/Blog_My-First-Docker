# Docker基礎入門：事前準備


どうも、ケニー（tsujikenzo）です。今日から新しいシリーズをお届けします。

VBAやGASをメインにプログラミング学習を行ってきた方は、あまり「環境」を意識することがなかったかもしれません。

それは、VBAはExcelやWordなどのアプリケーション内で動くため、環境構築が不要だったからです。GASも、Googleのクラウド上で動くため、環境構築が不要でした。どちらも「すぐに動かせる」環境が既に用意されていたのです。

しかし、Pythonを使うことが多くなったり、アプリを開発することが多くなると、状況が変わってきます。

Pythonのバージョンが違うと動かない
必要なライブラリのバージョンが違うと動かない
Macで動いたのに、Windowsで動かない
開発環境では動いたのに、本番環境では動かない
このような「環境の違い」による問題に直面することが増えてきます。

そこで役に立つのが、Docker（ドッカー）です。

Dockerを使えば、アプリとその実行環境を一緒にまとめることできるため、環境の違いを気にせずにアプリを動かせるようになります。たとえば、Macで作ったアプリを、WindowsやLinuxでも同じように動かせる。上司がWindows11で作ったアプリを、部下のWindows10で動かす。

もちろん、動かすだけでなく、開発するための環境構築もかんたんになり、効率が大幅に向上します。

それでは、さっそく、Dockerについて学んでいきましょう。

### この記事の目的

Dockerを理解するために、まず、以下の3つを理解することが重要です：

1. **アプリが動くために必要な環境**：CPU、メモリ、OS、ランタイム、ライブラリ、設定ファイル、データベースなど
2. **従来の問題**：環境の違いで動かない
3. **Dockerの解決方法**：環境ごとアプリを運ぶ

### 想定読者は？

- プログラミングを始めて間もない方
- VBAやGASなど「すぐ動かせる」環境に慣れている方
- PythonやWebアプリ開発で環境構築に悩んだことがある方
- Dockerについて「名前は聞いたことがあるけど使ったことがない」初学者

できるだけやさしく（具体例や図を交えながら）、Dockerの基礎を解説します。

## アプリが動くために必要な環境

アプリが動くためには、**ハードウェア**と**ソフトウェア（アプリ）**が必要です。

ハードウェアとは、物理的な装置（CPUやメモリ、ディスクなど）を指します。

ソフトウェア（アプリ）とは、ハードウェア上で実行されるプログラムやデータを指します。

たとえば、わたし世代がよく遊んだ、**ファミコン**と**ファミコンカセット**が分かりやすいでしょう。

> - **ファミコン本体** = **ハードウェア**（CPU、メモリ）
>   - 物理的な装置で、ゲームを動かすための基盤

> - **ファミコンカセット** = **ソフトウェア**（ゲームプログラム、データ）+ **ハードウェア**（ROMカートリッジ = ディスクに相当）
>   - カセットを差し込むと、ゲームが動く
>   - カセットには、ゲームプログラムだけでなく、必要なデータも含まれている
>   - カセットの中のROMカートリッジ（読み取り専用の記憶装置）が、パソコンでいうディスク（ファイルシステム）に相当する
 
パソコンも、同様です。
> - **パソコン本体** = **ハードウェア**（CPU、メモリ、ディスク）
> - **アプリやOS** = **ソフトウェア（アプリ）**（プログラムやデータ）

![ファミコンとファミコンカセットの例え](./img/001.png)

もう少しだけ、ハードウェアとソフトウェアについて、詳しくみてみましょう。

### ハードウェア（物理的な装置）

ハードウェアは、アプリを動かすための土台となる「実体」です。パソコンやサーバーなど、目に見える物理的な装置（CPU・メモリ・ディスクなど）を指します。

Dockerでは、このハードウェアの違い（例：Intel/AMD CPU、Apple Siliconなど）を意識せず、仮想的な同一環境でアプリを動かせるようにしてくれます。（詳細は次回以降のブログで）

**CPU（中央処理装置）：**
- プログラムの命令を実行する
- コンピュータの「頭脳」

**メモリ（主記憶装置）：**
- プログラムとデータを一時的に保存する場所
- CPUが直接アクセスできる高速な記憶装置

**ディスク（ファイルシステム）：**
- プログラムファイルやデータファイルを永続的に保存する場所
- メモリと違い、電源を切ってもデータが残る
- 例：Windowsなら「Cドライブ」、Mac/Linuxなら「/」など

これらのハードウェアを管理するのが「基本ソフト（OS）」です。

![ハードウェア](./img/002.png)

### ソフトウェア（プログラムやデータ）

「ソフトウェア（OSを含む）」とは、ハードウェア上で動作するプログラムや、そのプログラムが扱うデータのことを指します。

同じアプリ（ソフトウェア）であっても、実行するハードウェアや環境が異なるとうまく動かないことがあります。

この「環境の違いによる動作の不安定さ」こそが、Dockerが解決しようとしている大きな課題の一つです。（その詳細は次回以降のブログで紹介します）

**OS（オペレーティングシステム）：**
- Windows、Mac、Linuxなど
- プログラムをメモリにロードし、CPUに実行させる
- アプリは、OSの上で動く

**ランタイム環境：**
- アプリを実行するための環境
- プログラミング言語ごとに異なる
- 例：Pythonランタイム（Python 3.11）、PHPランタイム（PHP 8.1）、Node.jsランタイム（Node.js 18）など

**ライブラリ：**
- アプリが使う便利な機能の集まり
- 例：Flask、requests、expressなど
- **依存関係**：アプリが動くために必要なライブラリのリスト（「このライブラリのこのバージョンが必要」という情報）

**設定ファイル：**
- アプリの動作を制御するファイル
- データベースの接続情報、ポート番号など
- 例：WordPress → `wp-config.php`、MySQL → `my.cnf`、nginx → `nginx.conf`

**データベース（必要な場合）：**
- データを保存・管理するシステム
- WordPress、ECサイトなどで使用
- 例：MySQL、PostgreSQL、SQLite

アプリが正しく動作するためには、「ハードウェア」と「ソフトウェア」両方の環境が整っていることが重要です。どちらかが欠けたり違いがあると、思った通りにアプリが動かないことがあります。

![アプリの環境](./img/003.png)

## 従来の問題：環境の違い

ここまで、アプリが動くためには「ハードウェア」と「ソフトウェア」が必要だと説明してきました。

しかし、実際には**環境が違うとアプリが動かない**という問題があります。具体的には、以下の3つの問題があります。

- **問題1：OSの違い** - 例：Macで動いたのに、Windowsで動かない
- **問題2：依存関係の違い** - 例：開発者のPCでは動いたのに、他の人のPCでは動かない
- **問題3：設定ファイルの違い** - 例：開発環境では動いたのに、本番環境では動かない

それぞれ、みてみましょう。

### 問題1：OSの違い

**例：Macで開発 → Windowsで実行**

```
Mac環境：
- OS: macOS
- Python: 3.11
- ライブラリ: Flask 2.0

Windows環境：
- OS: Windows
- Python: 3.10（バージョンが違う！）
- ライブラリ: Flask 1.9（バージョンが違う！）

→ Macでは動いたのに、Windowsでは動かない
```

### 問題2：依存関係の違い

**例：同じOSでも動かない**

```
開発者のPC：
- Python 3.11
- Flask 2.0
- requests 2.28

他の人のPC：
- Python 3.11
- Flask 1.9（バージョンが違う！）
- requests 2.25（バージョンが違う！）

→ 開発者のPCでは動いたのに、他の人のPCでは動かない
```

### 問題3：設定ファイルの違い

**例：環境ごとに設定が異なる**

```
開発環境：
- データベース: localhost:3306
- ポート: 5000

本番環境：
- データベース: db.example.com:3306
- ポート: 80

→ 開発環境では動いたのに、本番環境では動かない
```

## Dockerの解決方法：環境ごとアプリを運ぶ

ここで活躍するのがDockerです。Dockerを使えば、アプリケーションとその動作に必要な環境ごとひとまとめにして持ち運ぶことができます。

### Dockerの考え方

Dockerは、**アプリとその実行環境を一緒にまとめて管理**します。

このようにまとめたものを、Dockerでは「**コンテナ**」と呼びます。

![コンテナ](./img/007.png)

このように、「アプリ+実行環境」をひとつのコンテナにまとめることで、誰でも、どこでも、いつでもアプリを「作る(Build)
」「運ぶ（Ship）」「実行（Run）」できるようになります。

![Docker](./img/008.png)



## まとめ

### アプリが動くために必要な環境

**ハードウェア（物理的な装置）：**
- **CPU**：プログラムの命令を実行する
- **メモリ**：プログラムとデータを一時的に保存する
- **ディスク**：プログラムファイルやデータファイルを永続的に保存する

**ソフトウェア（プログラムやデータ）：**
- **OS**：Windows、Mac、Linuxなど（プログラムをロード・実行する）
- **ランタイム環境**：Python、PHP、Node.jsなど
- **ライブラリ**：Flask、requests、expressなど
- **設定ファイル**：データベース接続情報、ポート番号など
- **データベース**（必要な場合）：MySQL、PostgreSQLなど

### 従来の問題

- **OSの違い**：Macで動いたのに、Windowsで動かない
- **依存関係の違い**：バージョンの違いでエラーが発生
- **設定ファイルの違い**：環境ごとに設定を変更する必要がある

### Dockerの解決方法

- **環境ごとアプリを運ぶ**：アプリとその実行環境を一緒にパッケージ化
- **環境に依存しない**：Mac、Windows、Linuxで同じように動く
- **依存関係の固定**：バージョンが固定されているため、環境の違いを気にしない

**アプリが動くために必要なもの**と**従来の問題**を理解することで、Dockerの必要性が明確になります！

---

## より詳しく学びたい方へ

この記事では、Docker学習に必要な最小限の知識を説明しました。

**より詳しく学びたい方は、以下の記事を参照してください：**

- **[詳細版：アプリが動く仕組み](./00_アプリが動く仕組み.md)** - CPU、メモリ、OSの詳細な動作、プログラムの動作環境、OSとアプリケーションの関係など、より詳しい説明があります

**次のステップ：**

- [Docker基礎入門](./01_Docker基礎入門.md)で、Dockerの基本を学びましょう
- [Docker用語解説](./00_Docker用語解説.md)で、Dockerの重要な用語を学びましょう

