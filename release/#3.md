どうも、ケニー（tsujikenzo）です。このシリーズでは、Docker入門をお届けしています。

前回は「Dockerコマンド編」で、docker run や docker ps などの基本コマンドを学びました。

https://tgg.jugani-japan.com/tsujike/docker002/

今回は、いよいよ「Dockerfile」を使って、自分のPythonアプリを動かせるイメージを作ってみます。

まずは、Dockerが解決する「環境の違い」の問題を、かんたんなハンズオンで体験してみましょう。

Pythonのバージョンが違うとアプリが動かない

次のような app.py を用意しました。「Hello」を表示するシンプルなものです。

import sys

if sys.version_info < (3, 13):
    raise RuntimeError("Python 3.13以上で動作します。")

print("Hello")

メモ帳でデスクトップに置いても構いませんし、こちらからダウンロードしていただいても大丈夫です。ファイルはデスクトップに移動してください。

Pythonアプリの実行

ターミナルを開いて、カレントディレクトリをデスクトップに移動します。

C:\Users\Kenzo>cd desktop

Pythonアプリを実行します。

C:\Users\Kenzo\Desktop>python app.py

問題なければ、ターミナルに「Hello」が表示されます。

もし、Pythonがインストールされていなかったり、Pythonのバージョンが13より低いと、エラーが発生し、アプリが動きません。

こちらは、わたしのサブのパソコンで実行した結果です。

調べてみたところ、このパソコンは、Pythonのバージョンが3.9でした。

このように、「同じアプリなのに、環境が違う」という問題は、よく起こります。

おさらいですが、そこで「アプリ+実行環境」をセットで配るのが、Dockerによる解決策です。

Dockerで、「アプリ+実行環境」をセットで配るための設計図が「Dockerfile（ドッカーファイル）」です。

Dockerfileとは


Python用イメージの選び方
最小のPythonアプリを作ってみる
Dockerfileを書く
docker build でイメージ作成
docker run で動作確認
よく使う命令（FROM / COPY / RUN / CMD）
まとめ
参考資料
このシリーズの目次

Dockerfileとは
Dockerfileは「イメージの設計図」です。
どんなOSを使うか、どのファイルを入れるか、どのコマンドを実行するかを記述します。

Python用イメージの選び方
今回は、Python初心者でも扱いやすい python:3.13-slim を使います。
slim は「軽量版」で、教材用途にちょうどよいサイズです。

最小のPythonアプリを作ってみる
まずは、以下の app.py を作ります。

import sys

if sys.version_info < (3, 13):
    raise RuntimeError("Python 3.13以上で動作します。")

print("はじめてのDockerfileにチャレンジ中です")

Dockerfileを書く
同じフォルダに、次のDockerfileを作成します。

FROM python:3.13-slim
WORKDIR /app
COPY app.py .
CMD ["python", "app.py"]

docker build でイメージ作成
以下のコマンドでイメージを作成します。

docker build -t my-python-app .

docker run で動作確認
作成したイメージを実行してみましょう。

docker run --rm my-python-app

Hello と表示されたら成功です。

よく使う命令（FROM / COPY / RUN / CMD）
FROM: ベースとなるイメージを指定する
COPY: ローカルのファイルをコンテナにコピーする
RUN: イメージ作成時にコマンドを実行する
CMD: コンテナ起動時に実行するコマンドを指定する

まとめ
今回は、Dockerfileを使ってPythonアプリを動かす基本を体験しました。
Dockerを使うと「アプリ + 実行環境」をまとめて配れるため、環境の違いによる不具合を減らせます。
次回は、もう少し実用的なアプリ（Webアプリなど）に広げていきます。

参考資料
Docker ドキュメント日本語化プロジェクト

このシリーズの目次
[Docker]ノンプログラマーのためのDocker入門 基礎知識編
[Docker]ノンプログラマーのためのDocker入門 Dockerコマンド編
[Docker]ノンプログラマーのためのDocker入門 Dockerfile編（Pythonアプリを動かす）
